<openerp>
    <data>


        <record id="advanced_view_account_payment_form" model="ir.ui.view">
            <field name="name">advanced_view_account_payment_form</field>
            <field name="model">account.payment</field>
            <field name="inherit_id" ref="account.view_account_payment_form"/>
            <field name="arch" type="xml">

                <button name="post" position="replace">
                    <button name="payment_request" class="oe_highlight" states="draft" string="Solicitar" type="object"/>
                    <button name="payment_request_print" class="oe_highlight" states="request" string="Imprimir Solicitud" type="object"/>
                    <button name="post" class="oe_highlight" states="request" string="Confirm" type="object"/>
                </button>


                <field name="state" position="replace">
                    <field name="state" widget="statusbar" statusbar_visible="request,posted,reconciled"/>
                </field>

                <sheet>

                    <group attrs="{'invisible': [('payment_type','=','transfer')]}">
                        <group>
                            <field name="move_type" attrs="{'readonly': [('state','!=','draft')]}"/>
                        </group>
                        <group>
                            <table class="table" states="draft">
                                <tr>
                                    <th class="tg-yw4l">
                                        <button name="update_invoice" type="object" string="Actulizar facturas pendientes"
                                                attrs="{'invisible': [('move_type','!=','invoice')]}"
                                                class="btn btn-sm btn-primary"/>
                                    </th>
                                    <th class="tg-yw4l">
                                        <button name="calc_invoice_check" type="object" string="Calcular pago"
                                                attrs="{'invisible': [('move_type','!=','invoice')]}"
                                                class="btn btn-sm btn-primary"/>
                                    </th>
                                    <th class="tg-yw4l">
                                        <button name="pay_all" type="object" string="Pagar todas"
                                                attrs="{'invisible': [('move_type','!=','invoice')]}"
                                                class="btn btn-sm btn-primary"/>
                                    </th>
                                </tr>
                            </table>
                        </group>
                    </group>

                    <field name="payment_invoice_ids" attrs="{'invisible': [('move_type','!=','invoice')],
                            'readonly': [('state','!=','draft')]}" mode="tree" options="{'reload_whole_on_button': false}">
                        <tree decoration-success="(balance == amount)"
                              decoration-danger="(amount == 0)"
                              decoration-warning="(amount &lt; balance)" limit="1000" create="false" edit="true" editable="top" delete="false">
                            <field name="state" invisible="1"/>
                            <button name="full_pay" type="object" string="Pagar" icon="kanban-apply" attrs="{'invisible': [('state','!=','draft')]}"/>
                            <button name="unfull_pay" type="object" string="No Pagar" icon="kanban-stop" attrs="{'invisible': [('state','!=','draft')]}"/>
                            <field name="move_line_id"/>
                            <field name="move_date" readonly="1"/>
                            <field name="date_maturity" readonly="1"/>
                            <field name="net" readonly="1"/>
                            <field name="balance_cash_basis" readonly="1"/>
                            <field name="balance" readonly="1"/>
                            <field name="amount"/>
                        </tree>
                    </field>

                    <field name="payment_move_ids" attrs="{'invisible': [('move_type','!=','manual')],
                            'readonly': [('state','!=','draft')]}">

                        <tree editable="bottom" string="Journal Items">
                            <field name="partner_id" invisible="0"
                                   domain="['|', ('parent_id', '=', False), ('is_company', '=', True)]"/>
                            <field name="product_id"/>
                            <field name="account_id" domain="[('deprecated', '=', False)]"/>
                            <field name="name"/>
                            <field name="analytic_account_id" groups="analytic.group_analytic_accounting"
                                   domain="[('account_type', '=', 'normal')]"/>
                            <field name="debit" sum="Total Debit"/>
                            <field name="credit" sum="Total Credit"/>
                        </tree>
                    </field>

                </sheet>
            </field>
        </record>

    </data>
</openerp>